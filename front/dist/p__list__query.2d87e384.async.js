(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2741],{55026:function(bt){bt.exports={main:"main___31kpQ",headerList:"headerList___2mK7o",stepDescription:"stepDescription___15qRg",pageHeader:"pageHeader___3Ha2b",moreInfo:"moreInfo___2mXTE"}},8778:function(bt,St,s){"use strict";s.r(St),s.d(St,{default:function(){return ra}});var qa=s(72012),er=s(39144),ja=s(66456),Ye=s(85453),Ca=s(59250),tr=s(13013),Ma=s(30887),Ke=s(99210),wa=s(74379),le=s(38648),ka=s(57663),me=s(71577),Ea=s(62350),Zt=s(75443),B=s(3182),m=s(11849),Ra=s(48736),ae=s(27049),Pa=s(9715),be=s(82482),b=s(2824),rr=s(94043),Z=s.n(rr),ar=s(76570),nr=s(1977),lr=s(73218),Tt=s(92104),qt=s(47760),jt=s(29934),ir=s(44545),sr=s(20924),ur=s(65233),or=s(64335),cr=s(15103),dr=s(21349),p=s(67294),te=s(58086);function Oa(){return Je.apply(this,arguments)}function Je(){return Je=_asyncToGenerator(_regeneratorRuntime.mark(function l(){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/profile/advanced"));case 1:case"end":return r.stop()}},l)})),Je.apply(this,arguments)}var Te=s(91896);function Fa(l,e){return Xe.apply(this,arguments)}function Xe(){return Xe=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/all",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),Xe.apply(this,arguments)}function Ct(l,e){return _e.apply(this,arguments)}function _e(){return _e=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/all",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),_e.apply(this,arguments)}function Ha(l,e){return et.apply(this,arguments)}function et(){return et=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/deleteThenReturnAll",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),et.apply(this,arguments)}function fr(l,e){return tt.apply(this,arguments)}function tt(){return tt=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/deleteThenReturnAll",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),tt.apply(this,arguments)}function Ia(l,e){return rt.apply(this,arguments)}function rt(){return rt=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),rt.apply(this,arguments)}function $a(l,e){return at.apply(this,arguments)}function at(){return at=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"POST",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),at.apply(this,arguments)}function Aa(l,e,r,u){return nt.apply(this,arguments)}function nt(){return nt=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r,u,h){var n,P;return _regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=_extends({},e),P=new FormData,u&&P.append("Filedata",u[0]||""),Object.keys(r).forEach(function(g){var x=r[g];x!=null&&P.append(g,typeof x=="object"?JSON.stringify(x):x)}),f.abrupt("return",request("/api/query/importCsv",_objectSpread({method:"POST",headers:{"Content-Type":"multipart/form-data"},params:_objectSpread({},n),data:P},h||{})));case 5:case"end":return f.stop()}},l)})),nt.apply(this,arguments)}function za(l,e){return lt.apply(this,arguments)}function lt(){return lt=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/querySql",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),lt.apply(this,arguments)}function mr(l,e){return it.apply(this,arguments)}function it(){return it=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/querySql",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),it.apply(this,arguments)}function Na(l,e){return st.apply(this,arguments)}function st(){return st=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/querySqlAppend",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),st.apply(this,arguments)}function vr(l,e){return ut.apply(this,arguments)}function ut(){return ut=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/querySqlAppend",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),ut.apply(this,arguments)}function Ga(l,e){return ot.apply(this,arguments)}function ot(){return ot=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/save",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),ot.apply(this,arguments)}function pr(l,e){return ct.apply(this,arguments)}function ct(){return ct=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/save",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),ct.apply(this,arguments)}function Qa(l,e){return dt.apply(this,arguments)}function dt(){return dt=_asyncToGenerator(_regeneratorRuntime.mark(function l(e,r){var u;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=_extends({},e),n.abrupt("return",request("/api/query/updatePoint",_objectSpread({method:"GET",params:_objectSpread({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),dt.apply(this,arguments)}function hr(l,e){return ft.apply(this,arguments)}function ft(){return ft=(0,B.Z)(Z().mark(function l(e,r){var u;return Z().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=(0,Te.Z)({},e),n.abrupt("return",(0,te.WY)("/api/query/updatePoint",(0,m.Z)({method:"POST",params:(0,m.Z)({},u)},r||{})));case 2:case"end":return n.stop()}},l)})),ft.apply(this,arguments)}var gr=s(55026),Se=s.n(gr);function yr(l,e,r){r!=null&&(l==null||l.code!="0")?r.error({message:l.message}):e(l)}function xr(l,e){var r=URL.createObjectURL(new Blob([l])),u=document.createElement("a");u.style.display="none",u.href=r,u.download=e,document.body.appendChild(u),u.click(),document.body.removeChild(u)}function br(l){var e=document.createElement("a");e.style.display="none",e.href=l,document.body.appendChild(e),e.click(),document.body.removeChild(e)}var Pe={dealCallback:yr,download:xr,download2:br},qe=s(86582),La=s(49111),Sr=s(19650),Va=s(43358),Zr=s(90290),Ua=s(47673),he=s(4107),Ne=s(37476),Tr=s(59879),Mt=s(43061),qr=s(30381),jr=s.n(qr),t=s(85893),Cr=he.Z.Search,Wa=he.Z.TextArea,Mr=function(e){var r=(0,te.YB)(),u=e.done,h=e.visible,n=e.content,P=e.setContent,I=e.querySql,f=e.activeQueryTabkey,g=e.setQuerySql,x=e.setVisible,a=(0,te.tT)("@@initialState"),O=a.initialState,A=a.setInitialState,Q=(0,p.useState)(void 0),w=(0,b.Z)(Q,2),j=w[0],L=w[1],k=Zr.Z.Option,M=be.Z.useForm(),U=(0,b.Z)(M,1),z=U[0],_=(0,te.QT)((0,B.Z)(Z().mark(function o(){return Z().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:case"end":return v.stop()}},o)}))),J=_.data,ee=_.loading,H=_.mutate,c=function(){var o=(0,B.Z)(Z().mark(function d(v,T,N){var E;return Z().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Ct({pageSize:10,pageNum:v,nameLike:N});case 2:E=C.sent,Pe.dealCallback(E,function(Y){var se=0;Y.data.pageItems.map(function(W){W.key=se++}),P(Y.data)},le.default);case 4:case"end":return C.stop()}},d)}));return function(v,T,N){return o.apply(this,arguments)}}(),y=function(){var o=(0,B.Z)(Z().mark(function d(v){var T;return Z().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,fr({queryId:v.id,pageSize:10,pageNum:1,nameLike:j});case 2:T=E.sent,Pe.dealCallback(T,function($){var C=0;$.data.pageItems.map(function(Y){Y.key=C++}),P($.data)},le.default);case 4:case"end":return E.stop()}},d)}));return function(v){return o.apply(this,arguments)}}(),i=[{title:r.formatMessage({id:"query.sql.script.name"}),dataIndex:"name",key:"name",width:"20%",render:function(d){return(0,t.jsx)("div",{children:d})}},{title:"SQL",dataIndex:"sqls",key:"sqls",width:"45%",render:function(d){return(0,t.jsx)("div",{children:d})}},{title:r.formatMessage({id:"query.sql.script.createTime"}),dataIndex:"createTime",key:"createTime",width:"20%",render:function(d){return(0,t.jsx)(t.Fragment,{children:jr()(parseInt(d)).format("YYYY-MM-DD HH:mm")})}},{title:r.formatMessage({id:"pages.operation.text"}),key:"action",render:function(d,v){return(0,t.jsxs)(Sr.Z,{size:"middle",children:[(0,t.jsx)("a",{onClick:function(N){I[f]=v.sqls,g((0,m.Z)({},I)),x(!1)},children:r.formatMessage({id:"pages.use.text"})}),(0,t.jsx)(Zt.Z,{placement:"left",title:v.name+" -- "+r.formatMessage({id:"pages.delete.confirm"}),onConfirm:function(N){return y(v,N)},children:(0,t.jsx)("a",{children:r.formatMessage({id:"pages.delete.text"})})})]})}}];return h?(0,t.jsx)(Ne.Z,{visible:h,form:z,title:r.formatMessage({id:"query.sql.script.view"}),className:Se().standardListForm,initialValues:n.pageItems,submitter:{submitButtonProps:{style:{display:"none"}},render:function(d,v){return(0,qe.Z)(v)}},modalProps:{onCancel:function(){return x(!1)},destroyOnClose:!0,bodyStyle:u?{padding:"72px 0"}:{}},children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{textAlign:"right",marginBottom:"10px",marginTop:"-10px"},children:(0,t.jsxs)(me.Z.Group,{children:[(0,t.jsxs)(me.Z,{value:"all",onClick:function(){L(null),c(1,10)},children:[(0,t.jsx)(Tr.Z,{}),r.formatMessage({id:"pages.refresh.text"})]}),(0,t.jsx)(Cr,{style:{width:"190px"},placeholder:r.formatMessage({id:"pages.refresh.placeholder"}),onSearch:function(d){c(1,10,d)},onChange:function(d){L(d.target.value)},value:j,suffix:j==null||j==""?(0,t.jsx)(Mt.Z,{style:{display:"none"}}):(0,t.jsx)(Mt.Z,{style:{color:"rgba(0,0,0,.45)"},onClick:function(){L(null)}})})]})}),(0,t.jsx)(Ye.Z,{columns:i,dataSource:n.pageItems,pagination:{showSizeChanger:!1,showQuickJumper:!0,pageSize:10,current:n==null?1:n.pageNo,total:n==null?1:n.totalCount,onChange:function(d,v){c(d,v,j)}}})]})}):null},wr=Mr,wt=s(5966),Da=he.Z.Search,Ba=he.Z.TextArea,kr=function(e){var r=(0,te.YB)(),u=e.done,h=e.visible,n=e.setVisible,P=e.querySql,I=e.activeQueryTabkey,f=be.Z.useForm(),g=(0,b.Z)(f,1),x=g[0],a=(0,te.QT)((0,B.Z)(Z().mark(function j(){return Z().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:case"end":return k.stop()}},j)}))),O=a.data,A=a.loading,Q=a.mutate,w=function(){var j=(0,B.Z)(Z().mark(function L(k){var M;return Z().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,pr({sqls:P[I],name:k});case 2:M=z.sent,Pe.dealCallback(M,function(_){le.default.success({message:r.formatMessage({id:"query.sql.script.save.success"})+" "+k}),n(!1)},le.default);case 4:case"end":return z.stop()}},L)}));return function(k){return j.apply(this,arguments)}}();return h?(0,t.jsx)(Ne.Z,{visible:h,form:x,title:r.formatMessage({id:"query.sql.script.create"}),className:Se().standardListForm,submitter:{render:function(L,k){return(0,qe.Z)(k)}},onFinish:function(L){w(L.name)},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:u?{padding:"72px 0"}:{}},children:(0,t.jsx)(wt.Z,{name:"name",label:r.formatMessage({id:"query.sql.script.name"}),rules:[{required:!0}]})}):null},Er=kr,Ya=s(13062),mt=s(71230),Ka=s(89032),je=s(15746),vt=s(86615),kt=s(64317),Et=s(29656),Rr=s(4631),Pr=s.n(Rr);(function(l){typeof exports=="object"?l(s(4631)):typeof define=="function"&&s.amdO?define(["../../../node_modules/codemirror/lib/codemirror"],l):l(Pr())})(function(l){"use strict";l.defineMode("iotdb-sql",function(f,g){var x=g.client||{},a=g.atoms||{false:!0,true:!0,null:!0},O=g.builtin||P(I),A=g.keywords||P(n),Q=g.operatorChars||/^[*+\-%<>!=&|~^\/]/,w=g.support||{},j=g.hooks||{},L=g.dateSQL||{date:!0,time:!0,timestamp:!0},k=g.backslashStringEscapes!==!1,M=g.brackets||/^[\{}\(\)\[\]]/,U=g.punctuation||/^[;.,:]/;function z(c,y){var i=c.next();if(j[i]){var o=j[i](c,y);if(o!==!1)return o}if(w.hexNumber&&(i=="0"&&c.match(/^[xX][0-9a-fA-F]+/)||(i=="x"||i=="X")&&c.match(/^'[0-9a-fA-F]+'/)))return"number";if(w.binaryNumber&&((i=="b"||i=="B")&&c.match(/^'[01]+'/)||i=="0"&&c.match(/^b[01]+/)))return"number";if(i.charCodeAt(0)>47&&i.charCodeAt(0)<58)return c.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),w.decimallessFloat&&c.match(/^\.(?!\.)/),"number";if(i=="?"&&(c.eatSpace()||c.eol()||c.eat(";")))return"variable-3";if(i=="'"||i=='"'&&w.doubleQuote)return y.tokenize=_(i),y.tokenize(c,y);if((w.nCharCast&&(i=="n"||i=="N")||w.charsetCast&&i=="_"&&c.match(/[a-z][a-z0-9]*/i))&&(c.peek()=="'"||c.peek()=='"'))return"keyword";if(w.escapeConstant&&(i=="e"||i=="E")&&(c.peek()=="'"||c.peek()=='"'&&w.doubleQuote))return y.tokenize=function(v,T){return(T.tokenize=_(v.next(),!0))(v,T)},"keyword";if(w.commentSlashSlash&&i=="/"&&c.eat("/"))return c.skipToEnd(),"comment";if(w.commentHash&&i=="#"||i=="-"&&c.eat("-")&&(!w.commentSpaceRequired||c.eat(" ")))return c.skipToEnd(),"comment";if(i=="/"&&c.eat("*"))return y.tokenize=J(1),y.tokenize(c,y);if(i=="."){if(w.zerolessFloat&&c.match(/^(?:\d+(?:e[+-]?\d+)?)/i))return"number";if(c.match(/^\.+/))return null;if(w.ODBCdotTable&&c.match(/^[\w\d_$#]+/))return"variable-2"}else{if(Q.test(i))return c.eatWhile(Q),"operator";if(M.test(i))return"bracket";if(U.test(i))return c.eatWhile(U),"punctuation";if(i=="{"&&(c.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||c.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";c.eatWhile(/^[_\w\d]/);var d=c.current().toLowerCase();return L.hasOwnProperty(d)&&(c.match(/^( )+'[^']*'/)||c.match(/^( )+"[^"]*"/))?"number":a.hasOwnProperty(d)?"atom":O.hasOwnProperty(d)?"builtin":A.hasOwnProperty(d)?"keyword":x.hasOwnProperty(d)?"string-2":null}}function _(c,y){return function(i,o){for(var d=!1,v;(v=i.next())!=null;){if(v==c&&!d){o.tokenize=z;break}d=(k||y)&&!d&&v=="\\"}return"string"}}function J(c){return function(y,i){var o=y.match(/^.*?(\/\*|\*\/)/);return o?o[1]=="/*"?i.tokenize=J(c+1):c>1?i.tokenize=J(c-1):i.tokenize=z:y.skipToEnd(),"comment"}}function ee(c,y,i){y.context={prev:y.context,indent:c.indentation(),col:c.column(),type:i}}function H(c){c.indent=c.context.indent,c.context=c.context.prev}return{startState:function(){return{tokenize:z,context:null}},token:function(y,i){if(y.sol()&&i.context&&i.context.align==null&&(i.context.align=!1),i.tokenize==z&&y.eatSpace())return null;var o=i.tokenize(y,i);if(o=="comment")return o;i.context&&i.context.align==null&&(i.context.align=!0);var d=y.current();return d=="("?ee(y,i,")"):d=="["?ee(y,i,"]"):i.context&&i.context.type==d&&H(i),o},indent:function(y,i){var o=y.context;if(!o)return l.Pass;var d=i.charAt(0)==o.type;return o.align?o.col+(d?0:1):o.indent+(d?0:f.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:w.commentSlashSlash?"//":w.commentHash?"#":"--",closeBrackets:"()[]{}''\"\"``"}});function e(f){for(var g;(g=f.next())!=null;)if(g=="`"&&!f.eat("`"))return"variable-2";return f.backUp(f.current().length-1),f.eatWhile(/\w/)?"variable-2":null}function r(f){for(var g;(g=f.next())!=null;)if(g=='"'&&!f.eat('"'))return"variable-2";return f.backUp(f.current().length-1),f.eatWhile(/\w/)?"variable-2":null}function u(f){return f.eat("@")&&(f.match("session."),f.match("local."),f.match("global.")),f.eat("'")?(f.match(/^.*'/),"variable-2"):f.eat('"')?(f.match(/^.*"/),"variable-2"):f.eat("`")?(f.match(/^.*`/),"variable-2"):f.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function h(f){return f.eat("N")?"atom":f.match(/^[a-zA-Z.#!?]/)?"variable-2":null}var n="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";function P(f){for(var g={},x=f.split(" "),a=0;a<x.length;++a)g[x[a]]=!0;return g}var I="bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric";l.defineMIME("text/iotdb-sql",{name:"sql",keywords:P("non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin int32 int64 float double boolean text false true null time timestamp lock any without debug explain tolerance like concat contain top asc desc stop start after before triggers trigger as functions function temporary schema for snapshot partition latest cache clear full global rename tags attributes compression align disable last last_value sum first_value avg max_value min_value max_time min_time level nodes count devices paths child move remove version info task flush ttl unset watermark_embedding load revoke password alter of all role privileges user list merge drop off on tracing using index link now values alias upsert add bitmap encoding insert create update delete select show query kill processlist grant into set where from to order by device configuration describe slimit limit unlink offset soffset fill linear previous previousuntillast metadata timeseries property with datatype compressor storage group label"),builtin:P("root now non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains max_time min_time max_value min_value last_value first_value sum avg count abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin false true null time timestamp int32 int64 float double boolean text"),atoms:P("plain plain_dictionary rle diff ts_2diff gorilla regular pla paa lzo gzip lz4 snappy uncompressed"),dateSQL:P(""),support:P("commentHash ODBCdotTable doubleQuote binaryNumber hexNumber")})});var Ja=s(71707),Xa=s(3585),_a=s(14504),en=he.Z.Search,tn=he.Z.TextArea,Or=function(e){var r=(0,te.YB)(),u=e.done,h=e.visible,n=e.setVisible,P=e.exportCsv,I=e.activeQueryTabkey,f=e.initExportSql,g=(0,te.tT)("@@initialState"),x=g.initialState,a=g.setInitialState,O=p.useState(void 0),A=(0,b.Z)(O,2),Q=A[0],w=A[1],j=(0,p.useState)({query1:"select * from root"}),L=(0,b.Z)(j,1),k=L[0],M=p.useState("number"),U=(0,b.Z)(M,2),z=U[0],_=U[1],J=p.useState("+08:00"),ee=(0,b.Z)(J,2),H=ee[0],c=ee[1],y=p.useState(!0),i=(0,b.Z)(y,2),o=i[0],d=i[1],v=p.useState("plain"),T=(0,b.Z)(v,2),N=T[0],E=T[1],$=be.Z.useForm(),C=(0,b.Z)($,1),Y=C[0],se=(0,t.jsx)(Et.Rt,{value:k.query1,options:{mode:"text/iotdb-sql",theme:"juejin",autofocus:!1,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Ctrl-/":"toggleComment"},matchBrackets:!0,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},onChange:function(V,ce,re){ce.origin!=null&&(ce.removed[0].trim()!=""||ce.text[0].match(/^[a-zA-Z0-9_]+$/))&&V.showHint(),k.query1=re}});return h?(0,t.jsxs)(Ne.Z,{visible:h,form:Y,title:r.formatMessage({id:"query.sql.export"}),className:Se().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(V,ce){return[].concat((0,qe.Z)(ce),[(0,t.jsx)(me.Z,{type:"primary",onClick:function(){P({queryCommand:k.query1,targetFile:Q,timeformat:z,timeZone:H,compress:N})},children:r.formatMessage({id:"query.sql.export"})},"export")])}},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:u?{padding:"72px 0"}:{}},children:[(0,t.jsx)("div",{style:{marginBottom:10},children:r.formatMessage({id:"query.sql.export.sqlWithRequired"})}),(0,t.jsx)("div",{style:{marginBottom:20},children:se}),(0,t.jsxs)(mt.Z,{gutter:16,children:[(0,t.jsx)(je.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(wt.Z,{name:"name",label:r.formatMessage({id:"query.sql.export.backupNameWithOptional"}),placeholder:"dump",fieldProps:{value:Q,onChange:function(V){w(V.target.value)}}})}),(0,t.jsx)(je.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(vt.Z.Group,{name:"compress",label:r.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:N,fieldProps:{buttonStyle:"solid",onChange:function(V){E(V.target.value)}}})})]}),(0,t.jsxs)(mt.Z,{gutter:16,children:[(0,t.jsx)(je.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(vt.Z.Group,{name:"tf",label:r.formatMessage({id:"query.sql.export.timeFormat"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.timeFormat.number"}),value:"number"},{label:r.formatMessage({id:"query.sql.export.timeFormat.default"}),value:"default"},{label:r.formatMessage({id:"query.sql.export.timeFormat.timestamp"}),value:"yyyy-MM-dd HH:mm:ss.SSS"}],initialValue:z,fieldProps:{buttonStyle:"solid",onChange:function(V){V.target.value=="number"?d(!0):d(!1),_(V.target.value)}}})}),(0,t.jsx)(je.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(kt.Z,{label:r.formatMessage({id:"query.sql.export.timeZone"}),name:"zone",disabled:o,options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{allowClear:!1,onChange:function(V){c(V)}}})})]})]}):null},Fr=Or,rn=s(43185),Hr=s(11324),an=he.Z.Search,nn=he.Z.TextArea,Ir=function(e){var r=(0,te.YB)(),u=e.done,h=e.visible,n=e.setVisible,P=e.activeQueryTabkey,I=e.initExportSql,f=p.useState(void 0),g=(0,b.Z)(f,2),x=g[0],a=g[1],O=p.useState("+08:00"),A=(0,b.Z)(O,2),Q=A[0],w=A[1],j=p.useState("plain"),L=(0,b.Z)(j,2),k=L[0],M=L[1],U=p.useState(0),z=(0,b.Z)(U,2),_=z[0],J=z[1],ee=p.useState(!1),H=(0,b.Z)(ee,2),c=H[0],y=H[1],i=be.Z.useForm(),o=(0,b.Z)(i,1),d=o[0];return h?(0,t.jsx)(Ne.Z,{visible:h,form:d,title:r.formatMessage({id:"query.sql.import"}),className:Se().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(T,N){return[].concat((0,qe.Z)(N),[(0,t.jsx)(Hr.Z,{action:"/api/query/importCsv",name:"Filedata",showUploadList:!1,data:{compress:k,timeZone:Q},beforeUpload:function($){var C=$.name,Y=C.substring(C.lastIndexOf(".")),se=$.size,W=3,V=Math.ceil(se/1024/1024),ce=Math.ceil(V*10);return k=="plain"&&Y!=".csv"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.no.rule"})}),!1):k=="snappy"&&Y!=".snappy"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.snappy.rule"})}),!1):k=="gzip"&&Y!=".gz"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.gzip.rule"})}),!1):V>W?(le.default.error({message:r.formatMessage({id:"query.sql.import.size.rule"})+" "+W+" MB"}),!1):!0},onChange:function($){$.file.response!=null&&(y(!1),($.file.response.code!="0"||$.file.status=="error")&&le.default.error({message:$.file.response.message}))},withCredentials:!0,children:(0,t.jsx)(me.Z,{type:"primary",children:r.formatMessage({id:"query.sql.import.selectFile"})},"import")},"upload")])}},modalProps:{onCancel:function(){n(!1)},destroyOnClose:!0,bodyStyle:u?{padding:"72px 0"}:{}},children:(0,t.jsxs)(mt.Z,{gutter:16,children:[(0,t.jsx)(je.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(vt.Z.Group,{name:"compress",label:r.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:k,fieldProps:{buttonStyle:"solid",onChange:function(T){M(T.target.value)}}})}),(0,t.jsx)(je.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(kt.Z,{label:r.formatMessage({id:"query.sql.export.timeZone"}),tooltip:r.formatMessage({id:"query.sql.export.timeZone.description"}),name:"zone",options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{value:Q,allowClear:!1,onChange:function(T){w(T)}}})})]})}):null},$r=Ir,Ar=s(55877),ln=s(402),Rt=s(59289),sn=s(77883),pt=s(51368),Ge=s(93224),zr=s(54549),Nr=s(79508),Gr=s(2603),Qr=s(81296),Lr=s(58848),ye;(function(l){l.INITHEIGHT="INITHEIGHT",l.RENDERTR="RENDERTR",l.RESET="RESET"})(ye||(ye={}));var Pt={rowHeight:0,curScrollTop:0,scrollHeight:0,tableScrollY:0};function Vr(l,e){var r=e.curScrollTop,u=e.scrollHeight,h=e.tableScrollY,n=e.rowHeight;switch(e.type){case ye.RENDERTR:return u<0&&(u=0),l.scrollHeight&&h===l.tableScrollY&&(u=l.scrollHeight),l.scrollHeight&&r>l.scrollHeight&&(r=l.scrollHeight),(0,m.Z)((0,m.Z)({},l),{},{curScrollTop:r,scrollHeight:u,tableScrollY:h});case ye.INITHEIGHT:return(0,m.Z)((0,m.Z)({},l),{},{rowHeight:n});case ye.RESET:return(0,m.Z)((0,m.Z)({},l),{},{curScrollTop:0,scrollHeight:0});default:throw new Error}}var ht=(0,p.createContext)({dispatch:Function,renderLen:1,start:0,offsetStart:0,rowHeight:Pt.rowHeight,totalLen:0}),gt=0,Oe=null,un=function(e){var r=e.children,u=_objectWithoutProperties(e,["children"]);return _jsx("td",_objectSpread(_objectSpread({},u),{},{children:_jsx("div",{children:"zxc"})}))},Ur=function(e){var r=(0,p.useContext)(ht),u=r.dispatch,h=r.rowHeight,n=r.totalLen,P=e.children,I=(0,Ge.Z)(e,["children"]),f=(0,p.useRef)(null);return(0,p.useEffect)(function(){var g=function(a){var O;if(a!=null&&(O=a.current)!==null&&O!==void 0&&O.offsetHeight&&!h&&n){var A,Q,w=(A=a==null||(Q=a.current)===null||Q===void 0?void 0:Q.offsetHeight)!==null&&A!==void 0?A:0;u({type:ye.INITHEIGHT,rowHeight:w})}};g(f)},[f,h,n,u]),(0,t.jsx)("tr",(0,m.Z)((0,m.Z)({},I),{},{ref:f,style:{height:h||"auto",boxSizing:"border-box"},children:P}))},Wr=function(e){var r=e.children,u=(0,Ge.Z)(e,["children"]),h=(0,p.useContext)(ht),n=h.renderLen,P=h.start,I=h.offsetStart,f=r[1],g=null;return Array.isArray(f)&&f.length?g=[r[0],f.slice(P,P+n).map(function(x){return Array.isArray(x)?x[0]:x})]:g=r,(0,t.jsx)("tbody",(0,m.Z)((0,m.Z)({},u),{},{style:{transform:"translateY(-".concat(I,"px)")},children:g}))},Ce=null,Dr=function(e){var r,u,h,n,P=e.style,I=e.children,f=(0,Ge.Z)(e,["style","children"]),g=(0,p.useReducer)(Vr,Pt),x=(0,b.Z)(g,2),a=x[0],O=x[1],A=(0,p.useRef)(null),Q=(0,p.useState)((r=(u=I[1])===null||u===void 0||(h=u.props)===null||h===void 0||(n=h.data)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0),w=(0,b.Z)(Q,2),j=w[0],L=w[1];(0,p.useEffect)(function(){var H,c,y;if((H=I[1])!==null&&H!==void 0&&(c=H.props)!==null&&c!==void 0&&(y=c.data)!==null&&y!==void 0&&y.length){var i,o,d;L((i=I[1])===null||i===void 0||(o=i.props)===null||o===void 0||(d=o.data)===null||d===void 0?void 0:d.length)}},[I]);var k=(0,p.useMemo)(function(){var H="auto";return a.rowHeight&&j&&(H=a.rowHeight*j+10),H},[a.rowHeight,j]),M=0;if(typeof gt=="string"){var U,z;M=(U=Ce.current)===null||U===void 0||(z=U.parentNode)===null||z===void 0?void 0:z.offsetHeight}else M=gt;(0,Qr.Z)(k)&&k<M&&(M=k),M<=0&&(M=0);var _=(0,p.useMemo)(function(){var H=1;if(a.rowHeight&&j&&M)if(M<=0)H=0;else{var c=(M/a.rowHeight|0)+1+2;H=c>j?j:c}return H},[a.rowHeight,j,M]),J=a.rowHeight?a.curScrollTop/a.rowHeight|0:0,ee=a.rowHeight?a.curScrollTop%a.rowHeight:0;return a.curScrollTop&&a.rowHeight&&a.curScrollTop>a.rowHeight?J>j-_?ee=0:J>1&&(J=J-1,ee+=a.rowHeight):J=0,(0,p.useEffect)(function(){var H,c,y=(H=Ce)===null||H===void 0||(c=H.current)===null||c===void 0?void 0:c.parentNode;y&&(y.scrollTop=0),O({type:ye.RESET})},[j]),(0,p.useEffect)(function(){var H,c,y=(0,Lr.Z)(function(o){var d,v,T,N,E,$,C=(d=o==null||(v=o.target)===null||v===void 0?void 0:v.scrollTop)!==null&&d!==void 0?d:0,Y=(T=o==null||(N=o.target)===null||N===void 0?void 0:N.scrollHeight)!==null&&T!==void 0?T:0,se=(E=o==null||($=o.target)===null||$===void 0?void 0:$.clientHeight)!==null&&E!==void 0?E:0;if(C===Y?Oe&&Oe():C+se===Y&&Oe&&Oe(),C!==a.curScrollTop){var W=o.target.scrollHeight-M;O({type:ye.RENDERTR,curScrollTop:C,scrollHeight:W,tableScrollY:M})}},60),i=(H=Ce)===null||H===void 0||(c=H.current)===null||c===void 0?void 0:c.parentNode;return i&&i.addEventListener("scroll",y),function(){i==null||i.removeEventListener("scroll",y)}},[Ce,a.curScrollTop,M,a.scrollHeight]),(0,t.jsx)("div",{ref:Ce,style:{width:"100%",position:"relative",height:k,boxSizing:"border-box",paddingTop:a.curScrollTop},children:(0,t.jsx)(ht.Provider,{value:{dispatch:O,start:J,offsetStart:ee,renderLen:_,totalLen:j,rowHeight:a.rowHeight},children:(0,t.jsx)("table",(0,m.Z)((0,m.Z)({},f),{},{ref:A,style:(0,m.Z)({width:"100%",position:"relative"},P),children:I}))})})},Br=function(e){var r=e.columns,u=e.scroll,h=e.sticky,n=e.pagination,P=e.editingKey,I=e.setEditingKey,f=e.form,g=e.updatePoint,x=e.data,a=e.setData,O=e.active,A=e.rowKey,Q=e.clearEditable,w=e.wrapTableRef,j=function(o){return o[A]===P},L=(0,p.useState)({}),k=(0,b.Z)(L,2),M=k[0],U=k[1],z=p.useRef(null),_={ref:z},J=function(o){var d=o.editing,v=o.dataIndex,T=o.title,N=o.inputType,E=o.record,$=o.index,C=o.children,Y=(0,Ge.Z)(o,["editing","dataIndex","title","inputType","record","index","children"]),se=N==="number"?(0,t.jsx)(pt.Z,{}):(0,t.jsx)(he.Z,{readOnly:M[v]!=!0,addonAfter:v!=null&&v.indexOf(".")<0?null:M[v]==!0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{title:"unsave",children:(0,t.jsx)(zr.Z,{style:{color:"#fc4c2f"},onClick:function(){var W=(0,B.Z)(Z().mark(function V(ce){var re;return Z().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:re={},re[v]=E[v],f.setFieldsValue((0,m.Z)({},re)),M[v]=!1,U((0,m.Z)({},M));case 5:case"end":return de.stop()}},V)}));return function(V){return W.apply(this,arguments)}}()})}),(0,t.jsx)(ae.Z,{type:"vertical"}),(0,t.jsx)("a",{title:"save",onClick:function(){var W=(0,B.Z)(Z().mark(function V(ce){var re,Fe,de,Me,Qe,He;return Z().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,g(E.Time,v,f.getFieldsValue()[v]);case 2:if(re=ie.sent,M[v]=!1,U((0,m.Z)({},M)),!(re!=null&&re.message!=null)){ie.next=20;break}if(re.code!="0"){ie.next=16;break}return ie.next=9,f.validateFields();case 9:Fe=ie.sent,de=(0,qe.Z)(x[O]),x[O]=de,Me=de.findIndex(function(ue){return E[A]===ue[A]}),Me>-1&&(Qe=de[Me],Qe[v]=Fe[v],x[O]=de,a((0,m.Z)({},x))),ie.next=20;break;case 16:le.default.error({message:re.message}),He={},He[v]=E[v],f.setFieldsValue((0,m.Z)({},He));case 20:case"end":return ie.stop()}},V)}));return function(V){return W.apply(this,arguments)}}(),children:(0,t.jsx)(Nr.Z,{style:{color:"#1890ff"}})})]}):(0,t.jsx)("a",{title:"click to unlock",onClick:function(){M[v]=!0,U((0,m.Z)({},M))},children:(0,t.jsx)(Gr.Z,{})})});return(0,t.jsx)("td",(0,m.Z)((0,m.Z)({},Y),{},{children:d?(0,t.jsx)(be.Z.Item,{name:v,style:{margin:0},rules:[],children:se}):C}))};r.length>1&&(r[0].render=function(i,o){return(0,t.jsxs)("span",{children:[x[O][o.index-1][r[0].key],(0,t.jsx)("div",{children:"\xA0"})]})},r[1].render=function(i,o){if(r[1].key=="Time"){var d=j(o);return d?(0,t.jsxs)("span",{children:[x[O][o.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Rt.Z.Link,{onClick:H,children:"finish"})})]}):(0,t.jsxs)("span",{children:[x[O][o.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Rt.Z.Link,{onClick:function(){return ee(o)},children:"edit"})})]})}else return x[O][o.index-1][r[1].key]});var ee=function(){var i=(0,B.Z)(Z().mark(function o(d){var v,T;return Z().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return U({}),E.next=3,f.validateFields();case 3:v=E.sent,T={},Object.keys(d).map(function($,C){$!=A&&(T[$]=d[$])}),Object.keys(r).map(function($,C){d[$]==null&&(T[$]=null)}),f.setFieldsValue((0,m.Z)({},T)),I(d[A]);case 9:case"end":return E.stop()}},o)}));return function(d){return i.apply(this,arguments)}}(),H=function(){Q()},c=function(){var i=(0,B.Z)(Z().mark(function o(d){var v,T,N,E;return Z().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,f.validateFields();case 3:v=C.sent,T=(0,qe.Z)(x[O]),N=T.findIndex(function(Y){return d[A]===Y[A]}),N>-1?(E=T[N],T.splice(N,1,(0,m.Z)((0,m.Z)({},E),v)),x[O]=T,a((0,m.Z)({},x))):(T.push(v),x[O]=T,a((0,m.Z)({},x))),C.next=12;break;case 9:C.prev=9,C.t0=C.catch(0),console.log("Validate Failed:",C.t0);case 12:Q();case 13:case"end":return C.stop()}},o,null,[[0,9]])}));return function(d){return i.apply(this,arguments)}}(),y=r.map(function(i){return i.editable?(0,m.Z)((0,m.Z)({},i),{},{onCell:function(d){return{record:d,inputType:"text",dataIndex:i.dataIndex,title:i.title,editing:j(d)}}}):i});return(0,t.jsx)(be.Z,{form:f,component:!1,children:(0,t.jsx)(Ye.Z,{components:Ot({height:450,cell:J,wrapTableRef:w}),bordered:!0,rowKey:A,dataSource:x[O],columns:y,rowClassName:"editable-row",scroll:u,sticky:h,pagination:n})})},Ot=function(e){return gt=e.height,Oe=e.onReachEnd,Ce=e.wrapTableRef,{table:Dr,body:{wrapper:Wr,row:Ur,cell:e.cell}}},Yr=function(e){return Br(e)},Kr=s(69610),Jr=s(54941),Xr=s(81306),_r=s(59206),ea=function(l){(0,Xr.Z)(r,l);var e=(0,_r.Z)(r);function r(){return(0,Kr.Z)(this,r),e.apply(this,arguments)}return(0,Jr.Z)(r,[{key:"render",value:function(){return this.props.addonAfter?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(pt.Z,(0,m.Z)({style:{borderBottomRightRadius:0,borderTopRightRadius:0}},this.props)),(0,t.jsx)("div",{className:"ant-input-group-addon",style:{marginTop:"-4px",paddingTop:"2px",display:"inline-table",lineHeight:"24px",height:"32px"},children:this.props.addonAfter})]}):(0,t.jsx)(pt.Z,(0,m.Z)({},this.props))}}]),r}(p.Component),ta=function(){var e=(0,te.YB)(),r=(0,te.tT)("@@initialState"),u=r.initialState,h=r.setInitialState,n=(0,p.useState)({query1:"SHOW STORAGE GROUP"}),P=(0,b.Z)(n,2),I=P[0],f=P[1],g=(0,p.useState)("query1"),x=(0,b.Z)(g,2),a=x[0],O=x[1],A=(0,p.useState)(!1),Q=(0,b.Z)(A,2),w=Q[0],j=Q[1],L=(0,p.useState)(!1),k=(0,b.Z)(L,2),M=k[0],U=k[1],z=(0,p.useState)(void 0),_=(0,b.Z)(z,2),J=_[0],ee=_[1],H=(0,p.useState)(!1),c=(0,b.Z)(H,2),y=c[0],i=c[1],o=(0,p.useState)(!1),d=(0,b.Z)(o,2),v=d[0],T=d[1],N=(0,p.useState)(!1),E=(0,b.Z)(N,2),$=E[0],C=E[1],Y=(0,p.useState)(void 0),se=(0,b.Z)(Y,2),W=se[0],V=se[1],ce=(0,p.useRef)(null),re=null,Fe=(0,t.jsx)(Et.Rt,{value:I[a],options:{mode:"text/iotdb-sql",theme:"juejin",autofocus:!0,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Ctrl-/":"toggleComment"},matchBrackets:!0,readOnly:w,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},onChange:function(S,F,R){F.origin!=null&&(F.removed[0].trim()!=""||F.text[0].match(/^[a-zA-Z0-9_]+$/))&&S.showHint(),I[a]=R}}),de=(0,p.useState)({tabActiveKey:"tab1",operationKey:"query1"}),Me=(0,b.Z)(de,2),Qe=Me[0],He=Me[1],Ft=(0,p.useState)({}),ie=(0,b.Z)(Ft,2),ue=ie[0],Ie=ie[1],Ze=(0,p.useRef)([]);(0,p.useEffect)(function(){Ze.current=ue},[ue]);var aa=(0,p.useState)([]),Ht=(0,b.Z)(aa,2),fe=Ht[0],Le=Ht[1],we=(0,p.useRef)([]);(0,p.useEffect)(function(){we.current=fe},[fe]);var na=(0,p.useState)([]),It=(0,b.Z)(na,2),ge=It[0],$e=It[1],ke=(0,p.useRef)([]);(0,p.useEffect)(function(){ke.current=ge},[ge]);var la=(0,p.useState)([]),$t=(0,b.Z)(la,2),ve=$t[0],At=$t[1],ia=(0,p.useState)([]),zt=(0,b.Z)(ia,2),xe=zt[0],sa=zt[1],ua=(0,p.useState)([]),Nt=(0,b.Z)(ua,2),Ae=Nt[0],oa=Nt[1],ca=(0,p.useState)([{}]),Gt=(0,b.Z)(ca,2),on=Gt[0],cn=Gt[1],da=(0,p.useState)(""),Qt=(0,b.Z)(da,2),fa=Qt[0],Lt=Qt[1],ma=(0,p.useState)([]),Vt=(0,b.Z)(ma,2),Ve=Vt[0],va=Vt[1],pa=be.Z.useForm(),ha=(0,b.Z)(pa,1),yt=ha[0],Ee=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ae.Z,{type:"vertical"}),(0,t.jsxs)("span",{children:[e.formatMessage({id:"query.result.locate.text"})," "]}),(0,t.jsx)(ea,{style:{width:100,size:"small"},placeholder:"Index..",min:0,max:1e7,onChange:function(S){Ve[a]=S,va((0,m.Z)({},Ve))},onPressEnter:function(){Ut()},addonAfter:(0,t.jsx)("a",{onClick:function(){Ut()},children:(0,t.jsx)(ar.Z,{})})})]}),Ut=function(){var S=Ve[a]==null?0:Ve[a];S=S<1?1:S;var F=77*(S-1);ce.current.parentNode.scrollTop=F},Wt=function(){var D=(0,B.Z)(Z().mark(function S(){var F,R,q,G,ne;return Z().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return Ze.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.ing"})]}),Ee]}),X.next=3,vr({queryToken:Ae[a]});case 3:if(F=X.sent,F.code=="0"){for(fe[a]=[],R=JSON.parse(F.message||"{}"),q=F.data==null?[]:F.data,G=ke.current[a].length,ve[a]=G+q.length,At((0,m.Z)({},ve)),R.hasMore?Ze.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){Wt()},children:e.formatMessage({id:"query.result.load.next"})}),Ee]}):Ze.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.done"})]}),Ee]}),Ie((0,m.Z)({},Ze.current)),ne=0;ne<q.length;ne++)Object.keys(q[ne]).map(function(oe,pe){if(we.current[a][oe]==null){var xt={title:oe,editable:!0,dataIndex:oe,width:200,key:oe,render:function(Ta){return Ta}};we.current[a][oe]=xt,we.current[a][we.current[a].length]=xt}}),q[ne].index=G+ne+1,ke.current[a][G+ne]=q[ne];ke.current[a]=ke.current[a].slice(),Le((0,m.Z)({},we.current)),$e((0,m.Z)({},ke.current))}else F.message!=null&&(Ze.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"}),"".concat(F.message)]}),Ee]}),Ie((0,m.Z)({},Ze.current)));case 5:case"end":return X.stop()}},S)}));return function(){return D.apply(this,arguments)}}(),ga=function(S,F){S.preventDefault();for(var R=We,q=0;q<R.length;q++)if(R[q]!=null&&R[q].key=="query"+F){R[q]=null;break}R=R.filter(function(G){return G!=null}),Bt(R),ze(),O("queryPlus"),Be("Plus"),j(!0)},Ue=1,ya=(0,p.useState)([{key:"query1",tab:(0,t.jsx)("span",{onClick:function(){O("query1"),Be(1),ze()},children:e.formatMessage({id:"query.query.text"})+"1"})},{key:"queryPlus",tab:(0,t.jsx)(nr.Z,{onClick:function(S,F){if(Ue==100){alert(e.formatMessage({id:"query.query.rule"}));return}Ue+=1;var R=We,q=We.length;R[q]=R[q-1],R[q-1]={key:"query"+Ue,tab:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{onClick:function(){O("query"+q),Be(q),ze()},children:[e.formatMessage({id:"query.query.text"})+Ue," "]}),(0,t.jsx)(Zt.Z,{title:"Sure to delete?",onConfirm:function(ne){ga(ne,q)},children:(0,t.jsx)(lr.Z,{style:{cursor:"default"},title:"delete"})})]})},R=R.filter(function(G){return G!=null}),Bt(R),O("query"+q),Be(q)}})}]),Dt=(0,b.Z)(ya,2),We=Dt[0],Bt=Dt[1],Yt=me.Z.Group,De=function(){return a=="queryPlus"||w?(alert(e.formatMessage({id:"query.query.description"})),!0):!1},ze=function(){var S={};Object.keys(yt.getFieldsValue()).map(function(F,R){S[F]=null}),yt.setFieldsValue((0,m.Z)({},S)),Lt("")},Kt=function(){var D=(0,B.Z)(Z().mark(function S(){var F,R,q,G;return Z().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(ze(),!De()){K.next=3;break}return K.abrupt("return");case 3:return ue[a]=null,Ie((0,m.Z)({},ue)),fe[a]=[],Le((0,m.Z)({},fe)),ge[a]=[],$e((0,m.Z)({},ge)),Ae[a]==null&&(F=(0,Ar.v4)().replaceAll("-",""),Ae[a]=F,oa((0,m.Z)({},Ae))),K.next=13,mr({sqls:I[a],queryToken:Ae[a]});case 13:R=K.sent,R.code=="0"?(q=JSON.parse(R.message||"{}"),G=R.data==null?[]:R.data,xe[a]=q.costMilliSecond==null?0:q.costMilliSecond,sa((0,m.Z)({},xe)),ve[a]=G.length,At(ve),q.hasMore?ue[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){Wt()},children:e.formatMessage({id:"query.result.load.next"})}),Ee]}):ue[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(xe[a]," ms"),(0,t.jsx)(ae.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ve[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ae.Z,{type:"vertical"}),"".concat(G.length==0?e.formatMessage({id:"query.result.execute.done"}):e.formatMessage({id:"query.result.load.done"}))]}),(0,t.jsx)("span",{children:Ee})]}),Ie((0,m.Z)({},ue)),G.length==0?(fe[a]=[],Le((0,m.Z)({},fe)),ge[a]=[],$e((0,m.Z)({},ge))):function(){for(var X=[],oe=0;oe<G.length;oe++)X.index==null&&(X.index={title:"index",editable:!1,dataIndex:"index",width:70,key:"index",fixed:"left"},X[X.length]=X.index),Object.keys(G[oe]).map(function(pe,xt){X[pe]==null&&(X[pe]={title:pe,editable:pe!="Time",dataIndex:pe,width:pe=="Time"?150:190,key:pe,fixed:pe=="Time"?"left":!1},X[X.length]=X[pe])}),G[oe].index=oe+1;fe[a]=X,Le((0,m.Z)({},fe)),ge[a]=G.slice(),$e((0,m.Z)({},ge))}()):(ue[a]=a+" "+e.formatMessage({id:"query.result.execute.failed"}),Ie((0,m.Z)({},ue)),le.default.error({message:R.message}));case 15:case"end":return K.stop()}},S)}));return function(){return D.apply(this,arguments)}}(),Jt=function(){De()||i(!0)},xa=function(){var D=(0,B.Z)(Z().mark(function S(F,R,q){var G;return Z().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(!De()){K.next=2;break}return K.abrupt("return");case 2:return K.next=5,hr({point:R,value:q,timestamp:F});case 5:return G=K.sent,K.abrupt("return",G);case 7:case"end":return K.stop()}},S)}));return function(F,R,q){return D.apply(this,arguments)}}(),Xt=function(){var D=(0,B.Z)(Z().mark(function S(){var F;return Z().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(!De()){q.next=2;break}return q.abrupt("return");case 2:return q.next=5,Ct({pageSize:10,pageNum:1});case 5:F=q.sent,Pe.dealCallback(F,function(G){var ne=0;G.data.pageItems.map(function(K){K.key=ne++}),ee(G.data),U(!0)},le.default);case 7:case"end":return q.stop()}},S)}));return function(){return D.apply(this,arguments)}}(),ba=function(S){if(S.queryCommand==null||S.queryCommand.trim()==""){le.default.error({message:e.formatMessage({id:"query.sql.export.required"})});return}var F="/api/query/exportCsv?sqls="+S.queryCommand+"&timeformat="+S.timeformat+"&timeZone="+S.timeZone+"&compress="+S.compress+"&targetFile="+(S.targetFile==null?"dump":S.targetFile);Pe.download2(F)},Sa=(0,t.jsx)(or.Z.Consumer,{children:function(S){var F=S.isMobile;return F?(0,t.jsx)(p.Fragment,{children:(0,t.jsxs)(Yt,{children:[(0,t.jsxs)(me.Z,{onClick:Jt,children:[(0,t.jsx)(Tt.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(me.Z,{onClick:Xt,children:[(0,t.jsx)(qt.Z,{}),e.formatMessage({id:"query.sql.script.view"})]}),(0,t.jsxs)(me.Z,{onClick:Kt,type:"primary",children:[(0,t.jsx)(jt.Z,{}),e.formatMessage({id:"query.sql.execute"})]})]})}):(0,t.jsx)(p.Fragment,{children:(0,t.jsxs)(Yt,{children:[(0,t.jsxs)(me.Z,{onClick:Kt,type:"primary",children:[(0,t.jsx)(jt.Z,{}),e.formatMessage({id:"query.sql.execute"})]}),(0,t.jsxs)(me.Z,{onClick:Jt,children:[(0,t.jsx)(qt.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(tr.Z.Button,{trigger:["hover"],onClick:Xt,icon:(0,t.jsx)(ir.Z,{}),overlay:(0,t.jsxs)(Ke.Z,{children:[(0,t.jsxs)(Ke.Z.Item,{onClick:function(){V(I[a]),T(!0)},children:[(0,t.jsx)(sr.Z,{})," ",e.formatMessage({id:"query.sql.export"})]},"exportCsv"),(0,t.jsxs)(Ke.Z.Item,{onClick:function(){V(I[a]),C(!0)},children:[(0,t.jsx)(ur.Z,{})," ",e.formatMessage({id:"query.sql.import"})]},"importCsv")]}),placement:"bottomRight",children:[(0,t.jsx)(Tt.Z,{}),e.formatMessage({id:"query.sql.script.view"})]})]})})}}),Za={},_t=Za.loading;re={queryPlus:(0,t.jsx)(Ye.Z,{pagination:!1,loading:_t,dataSource:[],columns:[],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,components:Ot({height:450})})};for(var Re=1;Re<100;Re++)re["query"+Re]=(0,t.jsx)(Yr,{rowKey:"index",loading:_t,columns:fe["query"+Re]==null?[]:fe["query"+Re],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,pagination:!1,data:ge,setData:$e,active:"query"+Re,editingKey:fa,setEditingKey:Lt,form:yt,clearEditable:ze,updatePoint:xa,wrapTableRef:ce});var Be=function(S){j(!1),He({tabActiveKey:"tab"+S,operationKey:"query"+S})};return(0,t.jsxs)(cr.ZP,{title:u.activeConnectionDesc,extra:Sa,className:Se().pageHeader,content:Fe,tabList:We,tabActiveKey:a,children:[(0,t.jsx)("div",{className:Se().main,children:(0,t.jsx)(dr.Z,{children:(0,t.jsx)(er.Z,{id:"s",className:Se().tabsCard,title:ue[a],bordered:!1,children:re[Qe.operationKey]})})}),(0,t.jsx)(wr,{visible:M,setVisible:U,content:J,setContent:ee,querySql:I,setQuerySql:f,activeQueryTabkey:a}),(0,t.jsx)(Er,{visible:y,setVisible:i,querySql:I,activeQueryTabkey:a}),(0,t.jsx)(Fr,{visible:v,setVisible:T,exportCsv:ba,activeQueryTabkey:a,initExportSql:W}),(0,t.jsx)($r,{destroyOnClose:!0,visible:$,setVisible:C,activeQueryTabkey:a,initExportSql:W})]})},ra=ta}}]);
